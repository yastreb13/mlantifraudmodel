# mlantifraudmodel
Проект по детекции мошеннических транзакций на основе **Credit Card Fraud Detection (Kaggle)**. Сам файл не приложил, так как его вес превышает максимальный, а найти его не создает трудностей.
Цель: построить антифрод-модель с учётом сильного дисбаланса классов, при низком срабатывании на нормальные операции.
## Данные
- `Class = 1` - мошенническая транзакция
- `Class = 0` - легитимная
Признаки:
- `V1–V28` - PCA-компоненты
- `Time` - время транзакции
- `Amount` - сумма транзакции
## EDA (Exploratory Data Analysis)
Выводы: В файле нет пропущенных значений, пристутсвует дисбаланс классов, в дальнейшем при обучении модели этот факт придется учесть. Из зашифрованных признаков видно корреляцию и антикорреляцию с таргет-классом, показываю свою информационную значимость. Замечена повышенная активность мошенников в ночные часы. Медиана транзацкий у обычных сделок выше, чем у мошеннических, однако на квантилях 95,99 мы видим резкое увеличение суммы. Также нашли значения для подсчета потерь.
## Обучение
time-based split - обучение на более ранних транзакциях, тестирование на более поздних (имитация продакшн-сценария).
За baseline взял: Logistic Regression с сбалансированными весами.
Улучшенная модель: Random Forest, CatBoost
Метрики:
- основная - PR-AUC (из-за сильного дисбаланса);
- дополнительно - ROC-AUC.
Подбор порога: по фиксированному Recall или по ограничению на FPR(ложные блокировки, как описал в начале). Также считаем потери банка, в eda нашли примерные необходимые данные.
Визуализация результатов
Для оценки модели используются:
- Precision–Recall curve;
- Recall - FPR;
- Вероятности срабатывания для fraud / legit.


## Как запустить обучение
Установка зависимостей:
pip install -r requirements.txt
